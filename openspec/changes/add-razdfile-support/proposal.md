# Change Proposal: Add Razdfile Support

**ID:** `add-razdfile-support`  
**Status:** Draft  
**Created:** 2025-11-08  
**Author:** AI Assistant

## Summary

Расширить расширение VSCode для поддержки обнаружения и работы с `Razdfile.yml` (и его вариантами) в дополнение к существующей поддержке `Taskfile.yml`.

## Why

В настоящее время расширение работает только с файлами `Taskfile.yml` (и его вариантами). Проект razd-cli использует альтернативное именование файлов конфигурации — `Razdfile.yml`. Без этого изменения пользователи razd-cli не смогут использовать данное расширение VSCode для работы со своими проектами, что ограничивает применимость расширения и требует создания дублирующих инструментов.

## Motivation

В настоящее время расширение обнаруживает только файлы с именами `Taskfile.yml`, `Taskfile.yaml`, `taskfile.yml`, `taskfile.yaml`. Для поддержки проекта razd-cli необходимо добавить возможность работы с альтернативными именами файлов: `Razdfile.yml`, `Razdfile.yaml`, `razdfile.yml`, `razdfile.yaml`.

## Goals

1. Добавить обнаружение файлов `Razdfile.yml` и его вариантов (`.yaml`, нижний регистр)
2. Сохранить обратную совместимость с существующим поведением `Taskfile.yml`
3. Обеспечить корректную работу всех функций расширения (инициализация, открытие, чтение) с обоими типами файлов

## What Changes

### Code Changes

1. **`src/services/taskfile.ts`** - Метод `open()`
   - Расширение массива `filenames` для включения 4 дополнительных вариантов: `Razdfile.yml`, `Razdfile.yaml`, `razdfile.yml`, `razdfile.yaml`
   - Порядок файлов: Taskfile варианты имеют приоритет, затем Razdfile варианты

2. **Тестовые файлы** - Новые тесты
   - Unit-тесты для проверки обнаружения всех вариантов Razdfile
   - Integration-тесты с реальными файлами
   - Регрессионные тесты для Taskfile

### Documentation Changes

1. **README.md**
   - Упоминание поддержки Razdfile.yml в описании функций
   - Примеры использования с обоими типами файлов

2. **CHANGELOG.md**
   - Запись о новой функциональности

### Specification Changes

1. **New Capability: `file-detection`**
   - REQ-FD-001: Razdfile Detection Support
   - REQ-FD-002: Обратная совместимость с Taskfile
   - REQ-FD-003: Расширенное логирование

## Non-Goals

- Изменение CLI инструмента `task` (это изменение касается только расширения VSCode)
- Поддержка одновременного использования обоих типов файлов в одной директории (приоритет будет определен)
- Изменение формата или структуры файлов

## Open Questions

1. **Приоритет обнаружения файлов**: Какой файл должен иметь приоритет при наличии обоих типов в одной директории?
   - Вариант A: `Taskfile.yml` имеет приоритет (сохранение текущего поведения)
   - Вариант B: `Razdfile.yml` имеет приоритет (новый формат)
   - Вариант C: Настраиваемый параметр в settings

2. **CLI команда для инициализации**: Должна ли команда инициализации создавать `Razdfile.yml` вместо `Taskfile.yml`?
   - Требуется уточнение о том, поддерживает ли CLI инструмент `razd` команду инициализации

3. **Название расширения и описание**: Должны ли мы обновить описание расширения для отражения поддержки обоих форматов?

## Impact

- **Пользователи**: Смогут использовать расширение с `Razdfile.yml`
- **Производительность**: Минимальное влияние (добавлено 4 дополнительных проверки файлов)
- **Совместимость**: Полная обратная совместимость с существующим поведением

## Alternatives Considered

1. **Создание отдельного расширения для razd**: Отклонено из-за дублирования кода
2. **Использование настройки для кастомных имен файлов**: Более гибко, но сложнее для пользователей
3. **Автоматическое определение на основе CLI**: Требует изменений в логике определения типа проекта

## Related Changes

Нет связанных изменений.

## Approval

- [ ] Требуется подтверждение ответов на открытые вопросы
- [ ] Требуется одобрение изменения перед реализацией
